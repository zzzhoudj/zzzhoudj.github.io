<!DOCTYPE html>
<html lang="en"> 
<head>
    <title>CCNet</title>
    
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Blog Template">
    <meta name="author" content="Xiaoying Riley at 3rd Wave Media">    
    <link rel="shortcut icon" href="favicon.ico"> 
    
    <!-- FontAwesome JS-->
    <script defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>
    
    <!-- Plugin CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/monokai-sublime.min.css">
    
    <!-- Theme CSS -->  
    <link id="theme-style" rel="stylesheet" href="assets/css/theme-1.css">
    

</head> 

<body>
    
    <header class="header text-center">	    
	    <h1 class="blog-name pt-lg-4 mb-0"><a href="index.html">UCAS-ZDJ</a></h1>
        
	    <nav class="navbar navbar-expand-lg navbar-dark" >
           
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
			</button>

			<div id="navigation" class="collapse navbar-collapse flex-column" >
				<div class="profile-section pt-3 pt-lg-0">
				    <img class="profile-image mb-3 rounded-circle mx-auto" src="assets/images/profile.png" alt="image" >			
					
					<div class="bio mb-2"><h5>周登继</h5></div>
					<div class="bio mb-3"><h5>中国科学院大学</h5></div>
					<!-- <ul class="social-list list-inline py-3 mx-auto">
			            <li class="list-inline-item"><a href="#"><i class="fab fa-twitter fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="#"><i class="fab fa-linkedin-in fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="#"><i class="fab fa-github-alt fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="#"><i class="fab fa-stack-overflow fa-fw"></i></a></li>
			            <li class="list-inline-item"><a href="#"><i class="fab fa-codepen fa-fw"></i></a></li>
					</ul> -->
					<a href="https://blog.csdn.net/qq_37935516" target="_blank" class="nav-item text-danger">CSDN</a>&nbsp;&nbsp;
					<a href="https://github.com/zzzhoudj" target="_blank" class="nav-item text-danger">GitHub</a>
			        <hr> 
				</div><!--//profile-section-->
				
				<ul class="navbar-nav flex-column text-left">
						<li class="nav-item active">
							<a class="nav-link" href="index.html"><i class="fas fa-home fa-fw mr-2"></i>博客主页 <span class="sr-only">(current)</span></a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="blog-list.html"><i class="fas fa-bookmark fa-fw mr-2"></i>博客列表</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="about.html"><i class="fas fa-user fa-fw mr-2"></i>关于我</a>
						</li>
					</ul>
					
					<div class="my-2 my-md-3">
						<a class="btn btn-primary" href="mailto:zhouengji19@mails.ucas.edu.cn">邮件联系</a>
					</div>
			</div>
		</nav>
    </header>
    
    <div class="main-wrapper">
	    
	    <article class="blog-post px-3 py-5 p-md-5">
		    <div class="container">
			    <header class="blog-post-header">
				    <h2 class="title mb-2">CCNet：Criss-Cross Attention for semantic Segmentation</h2>
				    <div class="meta mb-3"><span class="date">Published: 2019-08-17</span><span class="time">15 min read</span></div>
			    </header>
			    
			    <div class="blog-post-body">
				    <!-- <figure class="blog-banner">
				        <a href="#"><img class="img-fluid" src="assets/images/blog/blog-post-banner.jpg" alt="image"></a>
				        <figcaption class="mt-2 text-center image-caption">Image Credit: <a href="#?ref=devblog" target="_blank">made4dev.com (Premium Programming T-shirts)</a></figcaption>
					</figure> -->
					<blockquote>
							<p><small>本文也是Self-Attention机制的文章，该论文在捕获long-range上下文信息的同时提高了计算性能并减少了GPU内存，在Cityscapes、ADE20K和MSCOCO数据集上取得了先进性能。</small></p>
							<p><small>原文链接：<a href="https://arxiv.org/abs/1811.11721" target="_blank">https://arxiv.org/abs/1811.11721</a></small></p>
							<p><small>Github：<a href="https://github.com/speedinghzl/CCNet" target="_blank">https://github.com/speedinghzl/CCNet</a></small></p>
					</blockquote>
					<hr>
					<p>文中1*1卷积的理解：<a href="https://blog.csdn.net/renhaofan/article/details/82721868" target="_blank">https://blog.csdn.net/renhaofan/article/details/82721868</a></p>
					
					<h3 class="mt-5 mb-3">Abstract</h3>
				    <p>Long-range依赖能够捕获有用的上写完信息从而解决视觉理解问题。本文提出一种十字交叉的网络CCNet更有效地获得重要的信息。具体来说，CCNet能够通过一个新的交叉注意模块获取其周围像素在十字交叉路径上的上下文信息。通过这样反复的操作，每个像素最终能够从所有的像素中捕获long-range依赖。总体上CCNet有以下贡献：（1）节省GPU内存。与非局部模块non-local相比，循环十字交叉注意模块能够节省11倍的GPU内存占用；（2）更高的计算性能。循环交叉注意力模块在计算Long-range依赖时能够减少85% non-local FLOPs；（3）在语义分割数据集Cityscapes和ADE20K和实例分割数据集COCO上取得了先进性能。</p>
					
					<h3 class="mt-5 mb-3">Introduction</h3>
				    <p>为了捕获long-range依赖，Chen等人提出多尺度ASPP模块集成上下文信息；Zhao等人提出带有金字塔池化模块的PSPNet。然而空洞卷积只能从周围像素收集信息不能形成密集上下文信息，池化以非自适应方式集合上下文信息，对图像中的所有像素采用相同的方式，不能满足不同像素需要不同上下文依赖的条件。</p>
					<p>为了生成密集的基于像素的上下文信息，PSANet通过各位置的预测注意力图集成上下问信息；Non-local网络采用self-attention机制。然而这些基于attention的方法需要耗费大量时间和空间，有着较高的计算复杂度和占用太大GPU内存。</p>
					<p>本文有以下贡献：</p>
					<ul>
						<li>提出一种新的十字交叉注意力模块，能够以一种更高效的方式从long-range依赖中获取上下文信息；</li>
						<li>提出两层递归CCNet，在公开数据集上取得了先进性能。</li>
					</ul>
					<figure class="blog-banner"  style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-attention.jpg"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-attention.jpg" alt="image"></a>
							<figcaption class="mt-2 text-center image-caption">CCNet Attention Block和Non-local block的关系</figcaption>
					</figure>

					<h3 class="mt-5 mb-3">Approach</h3>
					<h4 class="mt-5 mb-3">Overview</h4>
					<p>网络结构图如下图所示，输入图片经过DCNN得到特征图X。为了保留更多的细节和更有效的生成密集特征图，移除DCNN中最后两个down-sampling操作，并将卷积层替换为空洞卷积，这样得到的特征图是输入图片的1/8大小。本文中采用的是ResNet-101作为主体网络。</p>
					<figure class="blog-banner">
							<a href="assets/images/blog/CCNet/CCNet-thumb.jpg"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-thumb.jpg" alt="image"></a>
							<figcaption class="mt-2 text-center image-caption">CCNet 结构图</figcaption>
					</figure>
					
					<p>获得特征图X之后，应用卷积得到一个降维的特征图H并将其喂入十字交叉注意模块CCA得到新的特征图H'。H'仅仅继承了水平和竖直方向的上下文信息还不足以进行语义分割。为了获得更丰富更密集的上下文信息，将特征图H'再次喂入注意模块中并得到特征图H''。这时H''的每个位置都继承了所有像素的信息。称递归结构为<b>递归十字交叉注意模块RCCA</b>。</p>
					<p>为什么递归两次就能从所有像素中捕获long-range依赖从而生成密集丰富的上下文特征呢？</p>
					<figure class="blog-banner"   style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-loop.jpg"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-loop.jpg" alt="image"></a>
							<figcaption class="mt-2 text-center image-caption">CCA中信息的传递与loop的关系</figcaption>
					</figure>
					<p>上图展示了右上角蓝色点如何将信息传递到左下角绿色点的过程，在loop1中，左下角点（ux,uy）只能得到左上角点（ux,oy）和右下角点（ox,uy）的信息，右上角点（ox,oy）蓝色点的信息只能传递到（ux,oy）和（ox,uy），还不能传播到左下角点（ux,uy）；在loop2中，左下角点（ux,uy）能够从左上角点（ux,oy）和右下角点（ox,uy）中得到信息，这时已经包含了蓝色点的信息，所以右上角点信息传播到左下角点。同理，任何不能一次遍历的位于十字位置的点只需两次就能完全遍历。</p>
					<h4 class="mt-5 mb-3">Criss-Cross Attention</h4>
					<figure class="blog-banner"   style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-criss-cross-attention.jpg"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-criss-cross-attention.jpg" alt="image"></a>
							<figcaption class="mt-2 text-center image-caption">Criss-Cross Attention模块原理</figcaption>
					</figure>
					<p>局部特征图H(C*W*H)采用1*1卷积降维得到特征图Q和K(C'*W*H)，其中C' &lt C。从Q中的某一个位置u，u其实就是一个像素，从Q中取出这个u，那个Qu其实就是一个通道维向量C'。同时，从K中与u相同位置处取出u所在的一行和一列共(H+W-1)个像素，即为特征向量Ωu，Ωu形状如下图（u就是十字中心位置）：</p>
					<figure class="blog-banner" style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-HW.jpg"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-HW.jpg" alt="image"></a>
					</figure>
					<p>Ωi,u是第i个Ωu，Affine操作就是：</p>
					<figure class="blog-banner"  style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-affine.jpg"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-affine.jpg" alt="image"></a>
					</figure>
					<p>因此A的大小为（H+W-1）*W*H</p>
					<p>从H经1*1卷积后得到另一卷积层V(C*W*H)，在空间维特征V中每一位置u得到向量Vu(C)和φu((H+W-1)*C)，然后将A与V中每一个u的特征向量做Aggregation操作：</p>
					<figure class="blog-banner"  style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-Aggregation.jpg"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-Aggregation.jpg" alt="image"></a>
					</figure>
					<p>从而得到输出的H'大小为C*W*H</p>

					<h3 class="mt-5 mb-3">Results</h3>
					<figure class="blog-banner"   style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-results.jpg"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-results.jpg" alt="image"></a>
							<figcaption class="mt-2 text-center image-caption">CCNet分割效果图</figcaption>
					</figure>
					<p>从上图中可以看到白色圈内的容易被错分，当loops增加后效果改善的很明显。</p>
					<figure class="blog-banner"   style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-loops-results.jpg"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-loops-results.jpg" alt="image"></a>
							<figcaption class="mt-2 text-center image-caption">CCNet在Cityscapes数据集上的测试</figcaption>
					</figure>
					<p>在Cityscapes验证集上的mIoU。</p>
					<figure class="blog-banner"   style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-cityscapes-result.png"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-cityscapes-result.png" alt="image"></a>
							<figcaption class="mt-2 text-center image-caption">CCNet在ADE20K数据集上的测试</figcaption>
					</figure>
					<p>在ADE20K上验证集上的mIoU。</p>
					<figure class="blog-banner"   style="text-align:center">
							<a href="assets/images/blog/CCNet/CCNet-ade20k-result.png"><img class="img-fluid" src="assets/images/blog/CCNet/CCNet-ade20k-result.png" alt="image"></a>
							<figcaption class="mt-2 text-center image-caption">CCNet RCCA模块与Non-local模块在GFLOPs/GPU-Memory/mIoU指标上的对比</figcaption>
					</figure>
					<p>上表中可以看到节省11倍的GPU memory和85%的计算性能。</p>
					<p>参考资料：</p>
					<ul>
						<li><a href="https://zhuanlan.zhihu.com/p/51393573" target="_blank">CCNet--于"阡陌交通"处超越恺明Non-local</a></li>
						<li><a href="https://zhuanlan.zhihu.com/p/57625603" target="_blank">CCNet: Criss-Cross Attention</a></li>
					</ul>

					<p><small>转载请联系：<a href="mailto:zhoudengji19@mails.ucas.edu.cn">zhoudengji19@mails.ucas.edu.cn</a></small></p>

				   
			    </div>
				    
			    <nav class="blog-nav nav nav-justified my-5">
				  <a class="nav-link-prev nav-item nav-link rounded-left" href="blog-list.html">Previous<i class="arrow-prev fas fa-long-arrow-alt-left"></i></a>
				  <a class="nav-link-next nav-item nav-link rounded-right" href="DANet.html">Next<i class="arrow-next fas fa-long-arrow-alt-right"></i></a>
				</nav>
				
		    </div><!--//container-->
		</article>
		    
	    <footer class="footer text-center py-2 theme-bg-dark">
				<small class="copyright">&copy 2019 • ZhouDengji</small>
	    </footer>
    
    </div><!--//main-wrapper-->
    

    <!-- *****CONFIGURE STYLE (REMOVE ON YOUR PRODUCTION SITE)****** -->  
    <div id="config-panel" class="config-panel d-none d-lg-block">
        <div class="panel-inner">
            <a id="config-trigger" class="config-trigger config-panel-hide text-center" href="#"><i class="fas fa-cog fa-spin mx-auto" data-fa-transform="down-6" ></i></a>
            <h5 class="panel-title">Choose Colour</h5>
            <ul id="color-options" class="list-inline mb-0">
                <li class="theme-1 active list-inline-item"><a data-style="assets/css/theme-1.css" href="#"></a></li>
                <li class="theme-2  list-inline-item"><a data-style="assets/css/theme-2.css" href="#"></a></li>
                <li class="theme-3  list-inline-item"><a data-style="assets/css/theme-3.css" href="#"></a></li>
                <li class="theme-4  list-inline-item"><a data-style="assets/css/theme-4.css" href="#"></a></li>
                <li class="theme-5  list-inline-item"><a data-style="assets/css/theme-5.css" href="#"></a></li>
                <li class="theme-6  list-inline-item"><a data-style="assets/css/theme-6.css" href="#"></a></li>
                <li class="theme-7  list-inline-item"><a data-style="assets/css/theme-7.css" href="#"></a></li>
                <li class="theme-8  list-inline-item"><a data-style="assets/css/theme-8.css" href="#"></a></li>
            </ul>
            <a id="config-close" class="close" href="#"><i class="fa fa-times-circle"></i></a>
        </div><!--//panel-inner-->
    </div><!--//configure-panel-->

    
       
    <!-- Javascript -->          
    <script src="assets/plugins/jquery-3.3.1.min.js"></script>
    <script src="assets/plugins/popper.min.js"></script> 
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script> 
    
    <!-- Page Specific JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>

    <!-- Custom JS -->
    <script src="assets/js/blog.js"></script>
    
    <!-- Style Switcher (REMOVE ON YOUR PRODUCTION SITE) -->
    <script src="assets/js/demo/style-switcher.js"></script>     
    

</body>
</html> 

